# UV手电筒详细电路设计

## 1. LED驱动电路
```
                    VIN(3.7V)
                        |
            C1(10uF)    L1(22uH)
                |          |
                |----------|-----> LED+
         -------|          |
        |       |          |
        | VIN   |     SW   |
        |       |          |
        |PT4115 |          |
        |       |     D1(SS34)
        | GND CS|          |
         -------|          |
                |          |
            R1(0.2Ω)       |
                |          |
                +----------+
                |
               LED-
```

## 2. 充电管理电路
```
                VCC(5V)
                  |
             C2(10uF)
                  |
Type-C      +----------+
VCC --------|VIN   VBAT|------ BAT+
GND --------|GND    GND|------ GND
            |          |
CC1 --------|PROG     |
            |   TP4056 |
CC2 --------|CHRG     |    R3(1.2K)
            |          |-----|<|---- LED1(RED)
            |STDBY     |    R4(1.2K)    
            |          |-----|<|---- LED2(GREEN)
            +----------+
                  |
             R2(2.2K)

        +----------------+
BAT+ ---|VDD        VSS |--- GND
        |                |
        |    DW01-P      |
        |                |
        |CS          OD  |--- G1
        |                |
        |OC          OC  |--- G2
        +----------------+
                  |
            FS8205A(双MOS)
                  |
BAT- ------------|
```

## 3. MCU控制电路
```
                   VDD(3.3V)
                      |
           C3(0.1uF)  R3(10K)
                |        |
         +-----|--------|------+
         |     |     NRST      |
         |   VDDA         PA0  |---> LED_PWM
         |                PA1  |---> KEY_IN
         |  STM32F030F4P6      |
         |                PA2  |---> TEMP_ADC
         |                PA3  |---> VBAT_ADC
         |     OSC            |
         +-----|--------|-----+
               |        |
           X1(8MHz)   C4,C5(20pF)
```

## 4. 电源管理电路
```
                    VIN(5V)
                       |
            D1(SS14)   |
Type-C+ ---|<|--------+
                       |
                    C1(22uF)
                       |
                   RT9013-3.3
                       |
                    C2(22uF)
                       |
                    VDD(3.3V)
```

## 5. 接口定义
```
1. Type-C接口
   - PIN1: GND
   - PIN2: CC1
   - PIN3: CC2
   - PIN4: VCC
   - PIN5: VCC
   - PIN6: GND

2. LED接口
   - PIN1: LED+
   - PIN2: LED-
   - PIN3: TEMP

3. 调试接口
   - PIN1: VDD
   - PIN2: SWDIO
   - PIN3: SWCLK
   - PIN4: GND
```

## 6. 关键器件参数

### 6.1 LED驱动部分
- PT4115:
  * 输入电压：3-18V
  * 最大输出电流：1.5A
  * 开关频率：250KHz
  * 效率：>90%

### 6.2 充电管理部分
- TP4056:
  * 输入电压：4.5-5.5V
  * 充电电流：最大1A
  * 充电精度：±1.5%
  * 终止电压：4.2V±1%

### 6.3 保护部分
- DW01-P:
  * 过充保护：4.3V
  * 过放保护：2.4V
  * 过流保护：3-5A
  * 短路保护：<50ms

### 6.4 MCU部分
- STM32F030F4P6:
  * 工作电压：2.4-3.6V
  * 工作频率：48MHz
  * ADC通道：11个
  * PWM通道：6个