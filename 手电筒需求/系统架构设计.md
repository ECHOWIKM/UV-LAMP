# UV手电筒系统架构设计

## 1. 系统框图
```
                                   升压控制
                                      ↓
+------------------+     +------------------+     +------------------+
|    电源输入      |     |    充电管理      |     |    电池系统      |
|   Type-C 5V     |---->|    TP4056       |---->|    18650        |
+------------------+     +--------+--------+     +--------+--------+
                                 |                        |
                                 |                        |
                        +--------v--------+        +------v-------+
                        |    电池保护      |        |   升压电路    |
                        |  DW01+FS8205A   |        |   MT3608    |
                        +--------+--------+        +------+-------+
                                 |                        |
                                 |                        |
                        +--------v--------+        +------v-------+
                        |  电压检测/ADC    |        |  恒流驱动    |
                        |    STM32F030    |------->|   PT4115    |
                        +--------+--------+        +------+-------+
                                 |                        |
                                 |                        |
                        +--------v--------+        +------v-------+
                        |    按键控制      |        |   UV-LED     |
                        |    人机交互      |        |   365nm     |
                        +-----------------+        +-------------+
```

## 2. 功能模块说明

### 2.1 电源系统
```
[电源输入] --> [充电管理] --> [电池系统] --> [升压模块] --> [恒流驱动]
   Type-C      TP4056        18650         MT3608       PT4115
    5V          1A充电        1.7-2.8V      3.7V         700mA
```

### 2.2 控制系统
```
[MCU控制器] -----> [升压控制] -----> [LED驱动]
STM32F030      MT3608反馈      PT4115
    |             |               |
    |             |               |
    v             v               v
[按键输入]     [电压检测]      [电流检测]
```

### 2.3 保护系统
```
[过压保护] --> [过流保护] --> [过温保护]
  4.2V         3A           65℃
    |             |            |
    v             v            v
[电池保护] --> [短路保护] --> [反接保护]
```

## 3. 信号流向图

### 3.1 电源信号
```
Type-C(5V) --> TP4056(充电IC) --> 电池(1.7-2.8V) --> MT3608(升压) --> PT4115(驱动) --> UV-LED
```

### 3.2 控制信号
```
按键输入 --> MCU --> MT3608使能 --> 升压输出
   |         |
   |         v
   +---> 模式切换 --> PT4115 PWM控制
```

### 3.3 检测信号
```
温度传感器 ---> ADC ---> MCU ---> 保护控制
电池电压   ---> ADC ---> MCU ---> 升压调节
LED电流    ---> ADC ---> MCU ---> 恒流控制
```

## 4. 工作模式流程

### 4.1 正常工作模式
```
开机 --> 电量检测 --> 升压启动 --> LED启动 --> 亮度调节 --> 温度监控
```

### 4.2 充电模式
```
插入充电 --> 充电检测 --> CC充电 --> CV充电 --> 充满截止
```

### 4.3 保护模式
```
异常检测 --> 触发保护 --> 关闭升压 --> 关闭输出 --> 故障指示
```

## 5. 关键参数

### 5.1 电气参数
- 输入电压：5V (Type-C)
- 电池电压：1.7-2.8V
- 升压输出：3.7V
- LED电流：700mA
- 充电电流：1A
- 功率效率：>85%

### 5.2 控制参数
- PWM频率：1KHz
- ADC采样：12位
- 温度阈值：65℃
- 电压阈值：1.7V/4.2V

### 5.3 保护参数
- 过压保护：4.3V
- 过流保护：3A
- 短路保护：<50ms
- 过温保护：65℃
```

这个系统架构设计图展示了：
1. 整体系统框图
2. 各功能模块的连接关系
3. 信号流向
4. 工作模式
5. 关键参数